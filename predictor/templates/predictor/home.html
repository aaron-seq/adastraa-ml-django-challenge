{% extends 'predictor/base.html' %}

{% block title %}Home - ML Prediction App{% endblock %}

{% block content %}
<div class="row justify-content-center">
    <div class="col-lg-8">
        <div class="card">
            <div class="card-header text-center">
                <h2 class="mb-0"><i class="fas fa-upload"></i> Sale Amount Prediction</h2>
                <p class="mb-0 mt-2">Upload your marketing campaign data to predict Sale_Amount</p>
            </div>
            <div class="card-body p-5">
                <form method="post" action="{% url 'upload_predict' %}" enctype="multipart/form-data" id="uploadForm">
                    {% csrf_token %}
                    
                    <div class="upload-area mb-4" id="uploadArea">
                        <i class="fas fa-cloud-upload-alt upload-icon"></i>
                        <h4>Upload Your Test Data</h4>
                        <p class="text-muted">Drag and drop your CSV file here or click to browse</p>
                        <input type="file" name="file" id="fileInput" class="form-control" accept=".csv" required style="display: none;">
                        <button type="button" class="btn btn-primary mt-3" onclick="document.getElementById('fileInput').click()">
                            <i class="fas fa-folder-open"></i> Choose File
                        </button>
                        <p id="fileName" class="mt-3 text-primary fw-bold"></p>
                    </div>

                    <div class="mb-4">
                        <h5><i class="fas fa-info-circle text-primary"></i> Required Columns:</h5>
                        <div class="row">
                            <div class="col-md-6">
                                <ul class="list-unstyled">
                                    <li><i class="fas fa-check text-success"></i> Ad_ID</li>
                                    <li><i class="fas fa-check text-success"></i> Campaign_Name</li>
                                    <li><i class="fas fa-check text-success"></i> Clicks</li>
                                    <li><i class="fas fa-check text-success"></i> Impressions</li>
                                    <li><i class="fas fa-check text-success"></i> Cost</li>
                                    <li><i class="fas fa-check text-success"></i> Leads</li>
                                </ul>
                            </div>
                            <div class="col-md-6">
                                <ul class="list-unstyled">
                                    <li><i class="fas fa-check text-success"></i> Conversions</li>
                                    <li><i class="fas fa-check text-success"></i> Conversion Rate</li>
                                    <li><i class="fas fa-check text-success"></i> Ad_Date</li>
                                    <li><i class="fas fa-check text-success"></i> Location</li>
                                    <li><i class="fas fa-check text-success"></i> Device</li>
                                    <li><i class="fas fa-check text-success"></i> Keyword</li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <div class="alert alert-info">
                        <i class="fas fa-lightbulb"></i> <strong>Note:</strong> The test CSV should NOT contain the Sale_Amount column. 
                        The model will predict this value for you.
                    </div>

                    <div class="text-center">
                        <button type="submit" class="btn btn-primary btn-lg" id="submitBtn" disabled>
                            <i class="fas fa-magic"></i> Generate Predictions
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Features Section -->
        <div class="row mt-4">
            <div class="col-md-4">
                <div class="card text-center h-100">
                    <div class="card-body">
                        <i class="fas fa-robot fa-3x text-primary mb-3"></i>
                        <h5>ML Powered</h5>
                        <p class="text-muted">Advanced machine learning algorithms</p>
                    </div>
                </div>
            </div>
            <div class="col-md-4">
                <div class="card text-center h-100">
                    <div class="card-body">
                        <i class="fas fa-tachometer-alt fa-3x text-success mb-3"></i>
                        <h5>Fast & Accurate</h5>
                        <p class="text-muted">Quick predictions with high accuracy</p>
                    </div>
                </div>
            </div>
            <div class="col-md-4">
                <div class="card text-center h-100">
                    <div class="card-body">
                        <i class="fas fa-download fa-3x text-info mb-3"></i>
                        <h5>Easy Export</h5>
                        <p class="text-muted">Download results as CSV instantly</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    const fileInput = document.getElementById('fileInput');
    const fileName = document.getElementById('fileName');
    const submitBtn = document.getElementById('submitBtn');
    const uploadArea = document.getElementById('uploadArea');

    fileInput.addEventListener('change', function(e) {
        if (this.files && this.files[0]) {
            fileName.textContent = 'Selected: ' + this.files[0].name;
            submitBtn.disabled = false;
        }
    });

    // Drag and drop functionality
    uploadArea.addEventListener('dragover', function(e) {
        e.preventDefault();
        this.style.borderColor = '#4F46E5';
        this.style.background = '#EEF2FF';
    });

    uploadArea.addEventListener('dragleave', function(e) {
        e.preventDefault();
        this.style.borderColor = '#CBD5E1';
        this.style.background = '#F8FAFC';
    });

    uploadArea.addEventListener('drop', function(e) {
        e.preventDefault();
        this.style.borderColor = '#CBD5E1';
        this.style.background = '#F8FAFC';
        
        const files = e.dataTransfer.files;
        if (files.length > 0) {
            fileInput.files = files;
            fileName.textContent = 'Selected: ' + files[0].name;
            submitBtn.disabled = false;
        }
    });
</script>
{% endblock %}
